<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Product Page with Cart & Payment</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      background: #f5f5f5;
    }
    #product1 {
      padding: 40px 80px;
    }
    .pro-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
    }
    .pro {
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      transition: 0.3s;
      position: relative;
      cursor: pointer;
    }
    .pro:hover {
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
      transform: scale(1.03);
    }
    .pro img {
      width: 100%;
      height: 250px;
      object-fit: cover;
      border-radius: 10px;
    }
    .des {
      margin-top: 15px;
    }
    .des span {
      font-size: 12px;
      color: #777;
    }
    .des h5 {
      font-size: 16px;
      margin: 5px 0;
    }
    .star {
      color: #ff9529;
    }
    .add-cart {
      position: absolute;
      right: 15px;
      bottom: 15px;
      background: #088178;
      color: #fff;
      padding: 10px;
      border-radius: 50%;
      font-size: 18px;
      text-decoration: none;
    }
    .add-cart:hover {
      background: #065f59;
    }
    #cartDetails {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: #fff;
      padding: 10px 20px;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
      z-index: 100;
    }
    #cartItems {
      max-height: 200px;
      overflow-y: auto;
      margin-bottom: 10px;
    }
    #cartItems li {
      margin: 5px 0;
    }
    #cartTotal {
      font-weight: bold;
    }
    #paymentForm {
      display: none;
      margin: 40px auto;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      width: 300px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    #paymentForm input, #paymentForm select, #paymentForm button {
      width: 100%;
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
    }
    #paymentForm button {
      background: #088178;
      color: white;
      border: none;
      cursor: pointer;
      transition: background 0.3s;
    }
    #paymentForm button:hover {
      background: #065f59;
    }
    #proceedBtn {
      background-color: #088178;
      color: white;
      font-size: 16px;
      padding: 15px 25px;
      border-radius: 5px;
      border: none;
      cursor: pointer;
      transition: 0.3s;
      font-weight: bold;
    }
    #proceedBtn:hover {
      background-color: #065f59;
      transform: scale(1.05);
    }
    #proceedBtn:active {
      transform: scale(1);
    }
    #qrImage {
      display: none;
      margin-top: 20px;
      text-align: center;
    }
    #qrImage img {
      width: 200px;
      height: auto;
    }
    .grand-total {
      font-size: 18px;
      font-weight: bold;
      margin-top: 20px;
    }
    small {
      font-size: 12px;
      color: red;
    }
  </style>
</head>
<body>
<section id="product1">
  <div class="pro-container" id="productContainer"></div>
</section>
<div id="cartDetails">
  <h3>Cart</h3>
  <ul id="cartItems"></ul>
  <h4>Total: $<span id="cartTotal">0</span></h4>
  <button id="proceedBtn" onclick="proceedToPayment()">Proceed to Payment</button>
</div>
<div id="paymentForm">
  <h3>Payment Details</h3>
  <label for="method">Select Payment Method</label>
  <select id="method" onchange="showPaymentFields()">
    <option value="">Choose...</option>
    <option value="credit">Credit Card</option>
    <option value="debit">Debit Card</option>
    <option value="upi">UPI</option>
    <option value="mobile">Mobile Banking</option>
  </select>
  <div id="cardDetails" style="display:none;">
    <input type="text" id="cardNumber" placeholder="Card Number (16 digits)" maxlength="19" oninput="validateCardNumber(this)" />
    <small id="cardNumberError" style="display:none;">Card number must be exactly 16 digits.</small>
    <input type="text" id="expiry" placeholder="MM/YY" maxlength="5" oninput="formatExpiry(this)" />
    <input type="password" id="cvv" placeholder="CVV (3 digits)" maxlength="3" oninput="allowOnlyDigits(this)" />
    <input type="password" id="otp" placeholder="OTP (4 digits)" maxlength="4" oninput="allowOnlyDigits(this)" />
  </div>
  <div id="upiDetails" style="display:none;">
    <input type="text" id="upi" placeholder="Enter UPI ID" />
    <input type="password" id="otpUpi" placeholder="OTP (6 digits)" maxlength="6" />
  </div>
  <div id="qrImage">
    <img src="C:/assignment/Flipzone zip/Flipzone/Qr.jpg" alt="Mobile Banking QR Code">
  </div>
  <div class="grand-total">
    Grand Total: $<span id="grandTotal">0</span>
  </div>
  <button onclick="validatePayment()">Pay Now</button>
</div>
<script>
const products = [
  { id: 1, name: "Smart Casual set", price: 78, img: "images/products/ff.jpg" },
  { id: 2, name: "Zaras Set", price: 85, img: "images/products/fff.jpg" },
  { id: 3, name: "Suit Trouser", price: 90, img: "images/products/ffff.jpg" },
  { id: 4, name: "Printed Shirts", price: 60, img: "images/products/f4.jpg" },
  { id: 5, name: "T-Shirt", price: 20, img: "images/products/f5.jpg" },
  { id: 6, name: "party Wear", price: 50, img: "images/products/f6.jpg" },
  { id: 7, name: "Vintage Look shorts", price: 30, img: "images/products/f7.jpg" },
  { id: 8, name: "Oversized T-Shirt", price: 80, img: "images/products/f8.jpg" },
];

let cart = [];

function addToCart(event, product) {
  event.preventDefault();
  const existingProduct = cart.find(item => item.id === product.id);

  if (existingProduct) {
    existingProduct.quantity++;
  } else {
    product.quantity = 1;
    cart.push(product);
  }
  
  updateCart();
}

function removeFromCart(id) {
  cart = cart.filter(item => item.id !== id);
  updateCart();
}

function updateCart() {
  const cartItems = document.getElementById("cartItems");
  cartItems.innerHTML = "";
  let total = 0;
  cart.forEach(item => {
    const li = document.createElement("li");
    li.innerHTML = `${item.name} - $${item.price} x ${item.quantity} 
                    <button onclick="removeFromCart(${item.id})">‚ùå</button>`;
    cartItems.appendChild(li);
    total += item.price * item.quantity;
  });
  document.getElementById("cartTotal").textContent = total;
  document.getElementById("grandTotal").textContent = total;
}

function renderProducts() {
  const container = document.getElementById("productContainer");
  container.innerHTML = "";
  products.forEach(product => {
    const html = `
      <div class="pro">
        <img src="${product.img}" alt="${product.name}">
        <div class="des">
          <span>adidas</span>
          <h5>${product.name}</h5>
          <div class="star">
            <i class="fas fa-star"></i><i class="fas fa-star"></i>
            <i class="fas fa-star"></i><i class="fas fa-star"></i>
            <i class="fas fa-star-half-alt"></i>
          </div>
          <h4>$${product.price}</h4>
        </div>
        <a href="#" onclick='addToCart(event, ${JSON.stringify(product)})' class="add-cart">
          <i class="fa-solid fa-cart-shopping"></i>
        </a>
      </div>
    `;
    container.insertAdjacentHTML("beforeend", html);
  });
}

function proceedToPayment() {
  if (cart.length === 0) {
    alert("Your cart is empty!");
    return;
  }
  document.getElementById("paymentForm").style.display = "block";
  document.getElementById("paymentForm").scrollIntoView({behavior: "smooth"});
}

function showPaymentFields() {
  const method = document.getElementById("method").value;
  document.getElementById("cardDetails").style.display = method === "credit" || method === "debit" ? "block" : "none";
  document.getElementById("upiDetails").style.display = method === "upi" ? "block" : "none";
  document.getElementById("qrImage").style.display = method === "mobile" ? "block" : "none";
}

function validatePayment() {
  const method = document.getElementById("method").value;
  if (!method) return alert("Please select a payment method.");
  
  if ((method === "credit" || method === "debit")) {
    const cardNumber = document.getElementById("cardNumber").value.replace(/\s/g, '');
    const expiry = document.getElementById("expiry").value;
    const cvv = document.getElementById("cvv").value;
    const otp = document.getElementById("otp").value;

    if (cardNumber.length !== 16) return alert("Card number must be exactly 16 digits.");
    if (!/^(0[1-9]|1[0-2])\/\d{2}$/.test(expiry)) return alert("Expiry must be in MM/YY format.");
    if (!/^\d{3}$/.test(cvv)) return alert("CVV must be 3 digits.");
    if (!/^\d{4}$/.test(otp)) return alert("OTP must be 4 digits.");
  }

  if (method === "upi") {
    const upi = document.getElementById("upi").value;
    const otpUpi = document.getElementById("otpUpi").value;
    if (!upi || otpUpi.length !== 6) return alert("Enter a valid UPI ID and 6-digit OTP.");
  }

  alert("Payment Successful! Thank you.");
  resetCart();
}

function resetCart() {
  cart = [];
  updateCart();
  document.getElementById("paymentForm").style.display = "none";
}

function validateCardNumber(input) {
  let digits = input.value.replace(/\D/g, '');
  if (digits.length > 16) digits = digits.slice(0, 16);

  let formatted = '';
  for (let i = 0; i < digits.length; i += 4) {
    formatted += digits.substr(i, 4) + ' ';
  }
  input.value = formatted.trim();

  const error = document.getElementById("cardNumberError");
  error.style.display = digits.length === 16 ? "none" : "block";
}

function formatExpiry(input) {
  let digits = input.value.replace(/\D/g, '');
  if (digits.length > 4) digits = digits.slice(0, 4);

  if (digits.length >= 3) {
    input.value = digits.slice(0, 2) + '/' + digits.slice(2);
  } else {
    input.value = digits;
  }
}

function allowOnlyDigits(input) {
  input.value = input.value.replace(/\D/g, '');
}

renderProducts();
</script>
</body>
</html>
